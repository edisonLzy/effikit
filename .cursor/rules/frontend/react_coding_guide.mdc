---
description: 
globs: 
alwaysApply: true
---
# React ç»„ä»¶ç¼–å†™è§„èŒƒ

## Goal

å»ºç«‹åŸºäº Hook First åŸåˆ™çš„ React ç»„ä»¶å¼€å‘æ ‡å‡†ï¼Œå®ç°è§†å›¾ä¸é€»è¾‘çš„ä¸¥æ ¼åˆ†ç¦»ï¼Œç¡®ä¿ä»£ç çš„å¯ç»´æŠ¤æ€§ã€å¯æµ‹è¯•æ€§å’Œå¯å¤ç”¨æ€§ã€‚

## Critical Rules

### **è§†å›¾ä¸é€»è¾‘ä¸¥æ ¼åˆ†ç¦»**
- **è§†å›¾å±‚**ï¼šç»„ä»¶åªè´Ÿè´£ UI æ¸²æŸ“å’Œç”¨æˆ·äº¤äº’äº‹ä»¶ç»‘å®š
- **é€»è¾‘å±‚**ï¼šæ‰€æœ‰ä¸šåŠ¡é€»è¾‘ã€çŠ¶æ€ç®¡ç†ã€å‰¯ä½œç”¨å¿…é¡»å°è£…åœ¨è‡ªå®šä¹‰ Hook ä¸­
- **æ•°æ®å±‚**ï¼šæ•°æ®è·å–ã€ç¼“å­˜ã€åŒæ­¥é€šè¿‡ä¸“é—¨çš„ Hook ç®¡ç†

### **Hook First åŸåˆ™**
- **ä¼˜å…ˆä½¿ç”¨è‡ªå®šä¹‰ Hook** å°è£…æ‰€æœ‰ä¸šåŠ¡é€»è¾‘
- **ç»„ä»¶å†…éƒ¨ç¦æ­¢ç›´æ¥å†™ä¸šåŠ¡é€»è¾‘**
- **æ¯ä¸ª Hook èŒè´£å•ä¸€ä¸”å¯å¤ç”¨**
- **ä½¿ç”¨ use å‰ç¼€å‘½å** æ‰€æœ‰è‡ªå®šä¹‰ Hook

### **ç»„ä»¶ç»“æ„æ ‡å‡†**

- **ç»„ä»¶å’Œhookæ ¼å¼**ï¼šä¸è¦ä½¿ç”¨constä»¥åŠFCå®šä¹‰ç»„ä»¶å’Œhook.
- **Props æ¥å£å®šä¹‰**ï¼šæ¯ä¸ªç»„ä»¶å¿…é¡»å®šä¹‰æ¸…æ™°çš„ Props æ¥å£
- **é”™è¯¯è¾¹ç•Œå¤„ç†**ï¼šåœ¨ Hook ä¸­ç»Ÿä¸€å¤„ç†é”™è¯¯ï¼Œç»„ä»¶åªè´Ÿè´£å±•ç¤ºé”™è¯¯çŠ¶æ€

### **Hook è®¾è®¡è§„èŒƒ**
- **èŒè´£åˆ†ç¦»**ï¼šæ•°æ®ç®¡ç†ã€æœç´¢é€»è¾‘ã€UI çŠ¶æ€åˆ†åˆ«ç”¨ä¸åŒ Hook å¤„ç†
- **Hook ç»„åˆ**ï¼šé€šè¿‡ç»„åˆå¤šä¸ªç®€å• Hook åˆ›å»ºå¤æ‚åŠŸèƒ½
- **è¿”å›å€¼ç»Ÿä¸€**ï¼šHook è¿”å›å¯¹è±¡åŒ…å«çŠ¶æ€ã€æ“ä½œå‡½æ•°å’Œé”™è¯¯å¤„ç†
- **å‰¯ä½œç”¨å°è£…**ï¼šæ‰€æœ‰ useEffect é€»è¾‘å°è£…åœ¨ Hook å†…éƒ¨

### **çŠ¶æ€ç®¡ç†åŸåˆ™**
- **æœ¬åœ°çŠ¶æ€ä¼˜å…ˆ**ï¼šç»„ä»¶å†…éƒ¨çŠ¶æ€ä½¿ç”¨ useState
- **å…¨å±€çŠ¶æ€è°¨æ…**ï¼šåªæœ‰çœŸæ­£éœ€è¦è·¨ç»„ä»¶å…±äº«çš„çŠ¶æ€æ‰ä½¿ç”¨ Context
- **çŠ¶æ€æå‡**ï¼šåœ¨åˆé€‚çš„å±‚çº§ç®¡ç†çŠ¶æ€ï¼Œé¿å…è¿‡åº¦æå‡
- **ä¸å¯å˜æ›´æ–°**ï¼šçŠ¶æ€æ›´æ–°éµå¾ªä¸å¯å˜åŸåˆ™

### **ç»„ä»¶æ‹†åˆ†ç­–ç•¥**
- **å®¹å™¨ç»„ä»¶ä¸å±•ç¤ºç»„ä»¶åˆ†ç¦»**ï¼šé€»è¾‘ç»„ä»¶è´Ÿè´£æ•°æ®ï¼Œå±•ç¤ºç»„ä»¶è´Ÿè´£æ¸²æŸ“
- **å•ä¸€èŒè´£åŸåˆ™**ï¼šæ¯ä¸ªç»„ä»¶åªè´Ÿè´£ä¸€ä¸ªæ˜ç¡®çš„åŠŸèƒ½
- **ç»„ä»¶ç²’åº¦åˆç†**ï¼šé¿å…è¿‡åº¦æ‹†åˆ†æˆ–å·¨å‹ç»„ä»¶
- **å¯å¤ç”¨æ€§è€ƒè™‘**ï¼šé€šç”¨ç»„ä»¶æŠ½å–åˆ° components ç›®å½•

## Examples

<example>

**æ­£ç¡®ç¤ºä¾‹ï¼šç»„ä»¶ç»“æ„**

```tsx
interface ToolbarProps {

}
function Toolbar(props: ToolbarProps){
    const { } = props;
}
```

**æ­£ç¡®ç¤ºä¾‹ï¼šHookç»“æ„**

```tsx
interface UseToolbarOptions {

}
function useToolbar(options: UseToolbarOptions){
    const { } = options;
}
```

**æ­£ç¡®ç¤ºä¾‹ï¼šè§†å›¾ä¸é€»è¾‘åˆ†ç¦»**

```tsx
// âœ… æ­£ç¡®ï¼šè§†å›¾ä¸é€»è¾‘åˆ†ç¦»
import React from 'react';
import { useToolManagement } from '@/hooks/useToolManagement';
import { useToolSearch } from '@/hooks/useToolSearch';
import { ToolList } from './ToolList';
import { SearchBar } from './SearchBar';

interface ToolManagerProps {
  initialTools?: Tool[];
}

export function ToolManager(props: ToolManagerProps){

  const { initialTools } = props;

  // ğŸ¯ æ‰€æœ‰é€»è¾‘é€šè¿‡ Hook å¤„ç†
  const {
    tools,
    enabledTools,
    isLoading,
    error,
    toggleTool,
    refreshTools
  } = useToolManagement(initialTools);

  const {
    searchTerm,
    filteredTools,
    handleSearch,
    clearSearch
  } = useToolSearch(tools);

  // ğŸ¯ ç»„ä»¶åªè´Ÿè´£æ¸²æŸ“å’Œäº‹ä»¶ç»‘å®š
  if (isLoading) {
    return <div className="loading">åŠ è½½ä¸­...</div>;
  }

  if (error) {
    return <div className="error">é”™è¯¯: {error}</div>;
  }

  return (
    <div className="tool-manager">
      <SearchBar
        value={searchTerm}
        onChange={handleSearch}
        onClear={clearSearch}
        placeholder="æœç´¢å·¥å…·..."
      />
      <ToolList
        tools={filteredTools}
        enabledTools={enabledTools}
        onToggle={toggleTool}
        onRefresh={refreshTools}
      />
    </div>
  );
};
```

**æ­£ç¡®ç¤ºä¾‹ï¼šè‡ªå®šä¹‰ Hook è®¾è®¡**
```tsx
// âœ… æ•°æ®ç®¡ç† Hook
function useToolData(initialTools: Tool[]) {
  const [tools, setTools] = useState<Tool[]>(initialTools);
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const addTool = useCallback((tool: Tool) => {
    setTools(prev => [...prev, tool]);
  }, []);

  const removeTool = useCallback((toolId: string) => {
    setTools(prev => prev.filter(t => t.id !== toolId));
  }, []);

  return {
    tools,
    isLoading,
    error,
    addTool,
    removeTool
  };
}

```

</example>

<example type="invalid">

**âŒ é”™è¯¯ï¼šç»„ä»¶å†…ç›´æ¥å†™ä¸šåŠ¡é€»è¾‘**
```tsx
// âŒ é”™è¯¯ï¼šä¸è¦åœ¨ç»„ä»¶å†…ç›´æ¥å†™ä¸šåŠ¡é€»è¾‘
export const ToolManager: React.FC<ToolManagerProps> = ({ initialTools }) => {
  const [tools, setTools] = useState(initialTools);
  const [searchTerm, setSearchTerm] = useState('');
  const [isLoading, setIsLoading] = useState(false);

  // âŒ ä¸è¦åœ¨ç»„ä»¶å†…ç›´æ¥å†™å¤æ‚é€»è¾‘
  const handleToggleTool = async (toolId: string) => {
    setIsLoading(true);
    try {
      const updatedTool = await api.toggleTool(toolId);
      setTools(prev => prev.map(tool => 
        tool.id === toolId ? updatedTool : tool
      ));
      await chrome.storage.local.set({ tools });
    } catch (error) {
      console.error('Toggle failed:', error);
    } finally {
      setIsLoading(false);
    }
  };

  // âŒ ä¸è¦åœ¨ç»„ä»¶å†…ç›´æ¥å†™æœç´¢é€»è¾‘
  const filteredTools = useMemo(() => {
    return tools.filter(tool => 
      tool.name.toLowerCase().includes(searchTerm.toLowerCase())
    );
  }, [tools, searchTerm]);

  return <div>{/* JSX */}</div>;
};
```

**âŒ é”™è¯¯ï¼šæ··åˆå¤šç§èŒè´£å’Œä½¿ç”¨ const å®šä¹‰ Hook**
```tsx
// âŒ é”™è¯¯ï¼šä¸€ä¸ª Hook å¤„ç†å¤šç§ä¸ç›¸å…³çš„é€»è¾‘ï¼Œä¸”ä½¿ç”¨ const å®šä¹‰
const useEverything = () => {
  const [tools, setTools] = useState([]);
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [searchTerm, setSearchTerm] = useState('');
  const [apiData, setApiData] = useState(null);
  
  // å¤ªå¤šä¸ç›¸å…³çš„é€»è¾‘æ··åˆåœ¨ä¸€èµ·
  // åº”è¯¥æ‹†åˆ†æˆç‹¬ç«‹çš„ Hook
  // ä¸”åº”è¯¥ä½¿ç”¨ function è€Œä¸æ˜¯ const
};
```

**âŒ é”™è¯¯ï¼šåœ¨ç»„ä»¶å†…ç›´æ¥è°ƒç”¨ API å’Œä½¿ç”¨ const å®šä¹‰ç»„ä»¶**
```tsx
// âŒ é”™è¯¯ï¼šç»„ä»¶å†…ç›´æ¥å¤„ç† API è°ƒç”¨ï¼Œä¸”ä½¿ç”¨ const å®šä¹‰ç»„ä»¶
const ToolManager = () => {
  const [tools, setTools] = useState([]);
  
  // âŒ ä¸è¦åœ¨ç»„ä»¶å†…ç›´æ¥å†™ API è°ƒç”¨
  const handleSave = async () => {
    const response = await fetch('/api/tools', {
      method: 'POST',
      body: JSON.stringify(tools)
    });
    // API å¤„ç†é€»è¾‘åº”è¯¥åœ¨ Hook ä¸­
  };

  return <div>{/* JSX */}</div>;
  // âŒ åº”è¯¥ä½¿ç”¨ function è€Œä¸æ˜¯ const å®šä¹‰ç»„ä»¶
};
```

**âŒ é”™è¯¯ï¼šå¿½ç•¥é”™è¯¯å¤„ç†å’Œä½¿ç”¨ const å®šä¹‰ Hook**
```tsx
// âŒ é”™è¯¯ï¼šæ²¡æœ‰é”™è¯¯å¤„ç†çš„ Hookï¼Œä¸”ä½¿ç”¨ const å®šä¹‰
const useToolData = () => {
  const [tools, setTools] = useState([]);
  
  // âŒ ç¼ºå°‘é”™è¯¯å¤„ç†
  const fetchTools = async () => {
    const data = await api.getTools(); // å¯èƒ½å¤±è´¥
    setTools(data);
  };

  return { tools, fetchTools };
  // âŒ åº”è¯¥ä½¿ç”¨ function è€Œä¸æ˜¯ const å®šä¹‰ Hook
};
  ```
</example>
